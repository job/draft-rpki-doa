<?xml version='1.0' encoding='utf-8'?>

<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<?rfc sortrefs="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>
<?rfc toc="yes"?>
<?rfc tocdepth="3"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude"
     category="std"
     docName="draft-spaghetti-sidrops-rpki-doa-00"
     ipr="trust200902"
     xml:lang="en"
     sortRefs="true"
     version="3">

  <front>

    <title abbrev="RPKI DOA">
      Resource Public Key Infrastructure (RPKI) object profile for Discard Origin Authorizations (DOA)
    </title>

    <seriesInfo name="Internet-Draft" value="draft-spaghetti-sidrops-rpki-doa-00"/>

    <author fullname="Job Snijders" initials="J." surname="Snijders">
      <organization>Fastly</organization>
      <address>
        <postal>
          <street/>
          <code/>
          <city>Amsterdam</city>
          <country>Netherlands</country>
        </postal>
        <email>job@fastly.com</email>
      </address>
    </author>

    <author fullname="Mikael Abrahamsson" initials="M." surname="Abrahamsson">
      <organization abbrev="NTT">NTT Ltd.</organization>
      <address>
        <postal>
          <street/>
          <code/>
          <city>Stockholm</city>
          <country>Sweden</country>
        </postal>
        <email>mikael@swm.pp.se</email>
      </address>
    </author>

    <author fullname="Ben Maddison" initials="B." surname="Maddison">
      <organization abbrev="Workonline">Workonline Communications</organization>
      <address>
        <postal>
          <street/>
          <city>Cape Town</city>
          <code/>
          <country>South Africa</country>
        </postal>
        <email>benm@workonline.africa</email>
      </address>
    </author>

    <abstract>
      <t>
        This document defines a Cryptographic Message Syntax (CMS) profile for Discard Origin Authorizations (DOAs), for use with the Resource Public Key Infrastructure (RPKI).
        A DOA is a digitally signed object that provides a means of verifying that an IP address block holder has authorized an Autonomous System (AS) to originate routes to one or more prefixes within the address block with a set of Border Gateway Protocol (BGP) Communities to signal a request to discard any traffic destined towards the tagged IP prefix.
      </t>
    </abstract>

    <note>
      <name>Requirements Language</name>
      <t>
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they appear in all capitals, as shown here.
      </t>
    </note>

  </front>

  <middle>

    <section anchor="intro">
      <name>Introduction</name>
      <t>
        This document defines a Cryptographic Message Syntax (CMS) <xref target="RFC5652"/> profile for Discard Origin Authorizations (DOAs), for use with the Resource Public Key Infrastructure (RPKI) <xref target="RFC6480"/>.
      </t>
      <t>
        TODO: Purpose - to authorise origination of blackhole routes, and signal the properties that such routes should have when received at an eBGP border.
      </t>
      <t>
        TODO: Document contents -
          eContentType definition;
          eContent definition;
          DOA object validation;
          BGP discard route matching.
      </t>
    </section>

    <section anchor="profile">
      <name>DOA EncapsulatedContentInfo</name>
      <t>
        DOA follows the Signed Object Template for the RPKI <xref target="RFC6488"/>.
      </t>
      <section anchor="asn1_mod">
        <name>ASN.1 Module</name>
        <t>
          The following ASN.1 module specifies the encapContentInfo component for DOA objects:
        </t>
        <sourcecode type="asn.1" src="RpkiDiscardOriginAuthorization-2021.asn"/>
      </section>
      <section anchor="econtent_type">
        <name>The DOA eContentType</name>
        <t>
          The eContentType for a DOA is defined as id-ct-discardOriginAuthorization as specified in <xref target="asn1_mod"/>.
        </t>
        <t>
          This OID MUST appear both within the eContentType in the encapContentInfo object as well as the ContentType signed attribute in the signerInfo object (see <xref target="RFC6488"/>).
        </t>
      </section>
      <section anchor="econtent">
        <name>The DOA eContent</name>
        <t>
          The content of a DOA is formally defined as DiscardOriginAuthorization as specified in <xref target="asn1_mod"/>
        </t>
        <section>
          <name>version</name>
          <t>
            The version number of the DiscardOriginAuthorization MUST be 0.
          </t>
        </section>
        <section>
          <name>ipAddrBlocks</name>
          <t>
            TODO
          </t>
        </section>
        <section>
          <name>originAsID</name>
          <t>
            TODO
          </t>
        </section>
        <section>
          <name>peerAsIDs</name>
          <t>
            TODO
          </t>
        </section>
        <section>
          <name>communities</name>
          <t>
            TODO
          </t>
        </section>
      </section>
    </section>

    <section anchor="validation">
      <name>DOA Validation</name>
      <t>
        To validate a DOA the relying party MUST perform all the validation checks specified in <xref target="RFC6488"/> as well as the following additional DOA-specific validation step:
      </t>
      <ul>
        <li>
          The IP delegation extension <xref target="RFC3779"/> MUST be present in the end-entity certificate (contained in the DOA), and every IP address prefix present in the ipAddrBlocks component of the DOA eContent is contained within the set of IP addresses specified in the EE certificate's IP address delegation extension.
        </li>
      </ul>
    </section>

    <section anchor="route_matching">
      <name>BGP Discard Route Matching</name>
      <t>
        TODO: Seperate document?
      </t>
    </section>

    <section anchor="operational">
      <name>Operational Considerations</name>
      <t>
        TODO
      </t>
    </section>

    <section anchor="security">
      <name>Security Considerations</name>
      <t>
        TODO
      </t>
    </section>

    <section removeInRFC="true">
      <name>Implementation status</name>
      <t>
        This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in RFC 7942.
        The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
        Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
        Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
        This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
        Readers are advised to note that other implementations may exist.
      </t>
      <t>
        According to RFC 7942, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
        It is up to the individual working groups to use this information as they see fit".
      </t>
      <ul>
        <li>
          A signer implementation <xref target="rpkimancer-doa"/> written in Python has been developed by Ben Maddison.
        </li>
      </ul>
    </section>

    <section anchor="iana">
      <name>IANA Considerations</name>

      <section>
        <name>SMI Security for S/MIME CMS Module Identifier (1.2.840.113549.1.9.16.0)</name>
        <t>
          The IANA is requested to register the following entry for this document in the "SMI Security for S/MIME CMS Module Identifier (1.2.840.113549.1.9.16.0)" registry:
        </t>
        <artwork>
<![CDATA[
   Decimal   Description                      References
   -----------------------------------------------------------------------------
   [TBD]     id-mod-rpkiDOA                   [draft-spaghetti-sidrops-rpki-doa]
]]>
        </artwork>
        <t>
          Upon publication of this document, IANA is requested to reference the RFC publication instead of this draft.
        </t>
      </section>

      <section>
        <name>SMI Security for S/MIME CMS Content Type (1.2.840.113549.1.9.16.1)</name>
        <t>
          The IANA is requested to register the following entry for this document in the "SMI Security for S/MIME CMS Content Type (1.2.840.113549.1.9.16.1)" registry:
        </t>
        <artwork>
<![CDATA[
   Decimal   Description                      References
   -----------------------------------------------------------------------------
   [TBD]     id-ct-discardOriginAuthorization   [draft-spaghetti-sidrops-rpki-doa]
]]>
        </artwork>
        <t>
          Upon publication of this document, IANA is requested to reference the RFC publication instead of this draft.
        </t>
      </section>

      <section>
        <name>RPKI Signed Objects registry</name>
        <t>
          The IANA is requested to register the OID for the RPKI Discard Origin Authorization in the "RPKI Signed Objects" registry (<xref target="RFC6488"/>) as follows:
        </t>
        <artwork>
<![CDATA[
   Name          OID                          Reference
   ----------------------------------------------------
   DOA           1.2.840.113549.1.9.16.1.TBD  [RFC-TBD]
]]>
        </artwork>
      </section>

      <section>
        <name>RPKI Repository Name Schemes registry</name>
        <t>
          The IANA is requested to register the RPKI Discard Origin Authorization file extension in the "RPKI Repository Name Schemes" registry (<xref target="RFC6481"/>) as follows:
        </t>
        <artwork>
<![CDATA[
   Filename Extension  RPKI Object                  Reference
   ----------------------------------------------------------
   .doa                Discard Origin Authorization   [RFC-TBD]
]]>
        </artwork>
      </section>

      <section>
        <name>Media Types registry</name>
        <t>
          The IANA is requested to register the media type application/rpki-doa in the "Media Types" registry (<xref target="RFC6838"/>) as follows:
        </t>
        <artwork>
<![CDATA[
   Type name: application
   Subtype name: rpki-doa
   Required parameters: None
   Optional parameters: None
   Encoding considerations: binary
   Security considerations: Carries an RPKI Discard Origin Authorization
                            [RFC-TBD].
   Interoperability considerations: None
   Published specification: This document.
   Applications that use this media type: RPKI operators.
   Additional information:
     Content: This media type is a signed object, as defined
              in [RFC6488], which contains a payload of a set of matching
              criteria as defined above in [RFC-TBD].
     Magic number(s): None
     File extension(s): .doa
     Macintosh file type code(s):
   Person & email address to contact for further information:
     Job Snijders <job@fastly.com>
   Intended usage: COMMON
   Restrictions on usage: None
   Author: Job Snijders <job@fastly.com>
   Change controller: Job Snijders <job@fastly.com>
]]>
        </artwork>
      </section>

    </section>

  </middle>

  <back>

    <references>
      <name>References</name>

      <references>
        <name>Normative References</name>
        <?rfc include="reference.RFC.2119.xml"?>
        <?rfc include="reference.RFC.3779.xml"?>
        <?rfc include="reference.RFC.5652.xml"?>
        <?rfc include="reference.RFC.6481.xml"?>
        <?rfc include="reference.RFC.6488.xml"?>
        <?rfc include="reference.RFC.6838.xml"?>
        <?rfc include="reference.RFC.8174.xml"?>
      </references>

      <references>
        <name>Informative References</name>
        <?rfc include="reference.RFC.6480.xml"?>
        <reference anchor="rpkimancer-doa" target="https://pypi.org/project/rpkimancer-doa/">
          <front>
            <title>rpkimancer-doa</title>
            <author initials="B." surname="Maddison">
              <organization>Workonline</organization>
            </author>
            <date year="2021" month="June"/>
          </front>
        </reference>
      </references>
    </references>

    <section anchor="Acknowledgements">
      <name>Acknowledgements</name>
      <t>
        TODO
      </t>
    </section>

    <section removeInRFC="true">
      <name>Document Changelog</name>
      <section>
        <name>Individual Submission Phase</name>
        <ul>
          <li/>
        </ul>
      </section>
    </section>

  </back>

</rfc>
